<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/favicon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon.png">
  <link rel="mask-icon" href="/blog/images/favicon.png" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">


<link rel="stylesheet" href="/blog/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"xiaoxiang-ma.github.io","root":"/blog/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"hide","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Designs an agent that tries to maximize “reward” by trial and error.Not supervised, but not unsupervised either.  Textbook PDF  The k-armed Bandit ProblemFaced repeatedly with a choice among k diffe">
<meta property="og:type" content="article">
<meta property="og:title" content="Bandit Problem">
<meta property="og:url" content="http://xiaoxiang-ma.github.io/blog/2020/06/13/rl-bandit/index.html">
<meta property="og:site_name" content="(▀̿Ĺ̯▀̿ ̿)">
<meta property="og:description" content="Designs an agent that tries to maximize “reward” by trial and error.Not supervised, but not unsupervised either.  Textbook PDF  The k-armed Bandit ProblemFaced repeatedly with a choice among k diffe">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://xiaoxiang-ma.github.io/blog/2020/06/13/rl-bandit/1equation.png">
<meta property="og:image" content="http://xiaoxiang-ma.github.io/blog/2020/06/13/rl-bandit/2actionvalue.png">
<meta property="og:image" content="http://xiaoxiang-ma.github.io/blog/2020/06/13/rl-bandit/4.png">
<meta property="og:image" content="http://xiaoxiang-ma.github.io/blog/2020/06/13/rl-bandit/5.png">
<meta property="og:image" content="http://xiaoxiang-ma.github.io/blog/2020/06/13/rl-bandit/7.png">
<meta property="og:image" content="http://xiaoxiang-ma.github.io/blog/2020/06/13/rl-bandit/6.png">
<meta property="og:image" content="http://xiaoxiang-ma.github.io/blog/2020/06/13/rl-bandit/8.png">
<meta property="article:published_time" content="2020-06-14T02:06:45.000Z">
<meta property="article:modified_time" content="2020-08-05T15:02:51.622Z">
<meta property="article:author" content="Xiaoxiang Ma">
<meta property="article:tag" content="笔记">
<meta property="article:tag" content="RL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://xiaoxiang-ma.github.io/blog/2020/06/13/rl-bandit/1equation.png">

<link rel="canonical" href="http://xiaoxiang-ma.github.io/blog/2020/06/13/rl-bandit/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Bandit Problem | (▀̿Ĺ̯▀̿ ̿)</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">(▀̿Ĺ̯▀̿ ̿)</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Ma blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/blog/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">13</span></a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">11</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/blog/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">4</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://xiaoxiang-ma.github.io/blog/2020/06/13/rl-bandit/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Xiaoxiang Ma">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="(▀̿Ĺ̯▀̿ ̿)">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Bandit Problem
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-06-13 22:06:45" itemprop="dateCreated datePublished" datetime="2020-06-13T22:06:45-04:00">2020-06-13</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Data-Science/" itemprop="url" rel="index"><span itemprop="name">Data Science</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <!-- ## Reinforcement Learning Notes -->

<p>Designs an agent that tries to maximize “reward” by trial and error.<br>Not supervised, but not unsupervised either.</p>
<!-- [Textbook](RL.pdf) -->
<a href="/blog/2020/06/13/rl-bandit/RL.pdf" title="Textbook PDF">Textbook PDF</a>

<h2 id="The-k-armed-Bandit-Problem"><a href="#The-k-armed-Bandit-Problem" class="headerlink" title="The k-armed Bandit Problem"></a>The k-armed Bandit Problem</h2><p>Faced repeatedly with a choice among k different options. After each choice you receive a numerical reward chosen from a stationary probability distribution that depends on the action you selected. The objective is to maximize the expected total reward over some time period, for example, over 1000 action selections, or time steps.</p>
<a id="more"></a>

<!-- ![True value of action](1equation.png) -->
<img src="/blog/2020/06/13/rl-bandit/1equation.png" class="" title="True value of action">

<p>Value of an action is the expected value of reward given that action is selected.</p>
<ul>
<li>q*(a): TRUE Value of an action (Note known)</li>
<li>Qt(a): estimated value of action a at time step t, We would like Q t (a) to be close to q*(a).</li>
<li>At: Action selected on time step t</li>
<li>Rt: Corresponding Reward on time step t</li>
</ul>
<p>Goal is to maximize argmax of q*(a)</p>
<blockquote>
<p>Each of the k actions has an expected or mean reward given that that action is selected; let us call this the value of that action. We denote the action selected on time step t as A t , and the corresponding reward as R t . The value then of an arbitrary action a, denoted q ⇤ (a), is the expected reward given that a is selected</p>
</blockquote>
<h2 id="Action-Value-amp-increment-estimation"><a href="#Action-Value-amp-increment-estimation" class="headerlink" title="Action-Value &amp; increment estimation"></a>Action-Value &amp; increment estimation</h2><p>Sample average method: Take the average of action-values so far.</p>
<!-- ![Sample avg (predicted) action value](2actionvalue.png) -->
<img src="/blog/2020/06/13/rl-bandit/2actionvalue.png" class="" title="Sample avg (predicted) action value">

<!-- ![Action value](3.png) -->

<p>Action Selection:</p>
<ul>
<li>Exploit / Greedy: argmax Qt(a) (choose the current largest estimate action / most reward right now)</li>
<li>Explore: choose other than the largest estimate randomly.</li>
</ul>
<p><mark>Exploitation is the right thing to do to maximize the expected reward on the one step, but exploration may produce the greater total reward in the long run.</mark></p>
<!-- ![Increment (R = reward)](4.png) -->
<img src="/blog/2020/06/13/rl-bandit/4.png" class="" title="Increment (R &#x3D; reward)">

<p>NewEstimate = OldEstimate + StepSize (Target - OldEstimate)</p>
<p><strong>Nonstationary Problem</strong><br>Performance changes with time. (e.g. a medicine more effective in winter)</p>
<!-- ![Constant step size](5.png) -->
<img src="/blog/2020/06/13/rl-bandit/5.png" class="" title="Constant step size">

<ul>
<li>alpha is constant, more recent rewards affect more than older rewards.</li>
<li>weight decays exponentially according to the exponent on 1- alpha.</li>
</ul>
<h2 id="Epsilon-Greedy-amp-optimistic-initial-value"><a href="#Epsilon-Greedy-amp-optimistic-initial-value" class="headerlink" title="Epsilon Greedy &amp; optimistic initial value"></a>Epsilon Greedy &amp; optimistic initial value</h2><p>Epsilon = prob of choosing to explore.<br>The smaller, the longer it takes for curve to plateu.</p>
<!-- ![Epsilon](7.png) -->
<img src="/blog/2020/06/13/rl-bandit/7.png" class="" title="Epsilon">

<!-- ![Optimistic int val](6.png) -->
<img src="/blog/2020/06/13/rl-bandit/6.png" class="" title="Optimistic int val">

<ul>
<li><strong>Worse at first due to more exploration, exploration decreases with time (not goot for nonstationary problems).</strong></li>
<li>The system does a fair amount of exploration even if greedy actions are selected all the time.</li>
</ul>
<h2 id="Upper-Conﬁdence-Bound-Action-Selection"><a href="#Upper-Conﬁdence-Bound-Action-Selection" class="headerlink" title="Upper-Conﬁdence-Bound Action Selection"></a>Upper-Conﬁdence-Bound Action Selection</h2><p>Action selection method that chooses the most “unexplored” / “uncertain” actions when not choosing to exploit.</p>
<!-- ![UCB](8.png) -->
<img src="/blog/2020/06/13/rl-bandit/8.png" class="" title="UCB">

<blockquote>
<p>N t(a) denotes the number of times that action a has been selected prior to time t (the denominator in (2.1)), and the number c &gt; 0 controls the degree of exploration. If N t (a) = 0, then a is considered to be a maximizing action.</p>
</blockquote>
<blockquote>
<p>The idea of this upper conﬁdence bound (UCB) action selection is that the square-root term is a measure of the uncertainty or variance in the estimate of a’s value. The quantity being max’ed over is thus a sort of upper bound on the possible true value of action a, with c determining the conﬁdence level. <strong><em>Each time a is selected the uncertainty is presumably reduced: N t (a) increments, and, as it appears in the denominator, the uncertainty term decreases.</em></strong> On the other hand, each time an action other than a is selected, t increases but N t (a) does not; because t appears in the numerator, the uncertainty estimate increases. The use of the natural logarithm means that the increases get smaller over time, but are unbounded; all actions will eventually be selected, but actions with lower value estimates, or that have already been selected frequently, will be selected with decreasing frequency over time.</p>
</blockquote>
<!-- [Week 1 Summary](summary.mp4) -->
<a href="/blog/2020/06/13/rl-bandit/summary.mp4" title="Video: Week 1 Summary">Video: Week 1 Summary</a>



    </div>

    
    
    

      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/blog/tags/%E7%AC%94%E8%AE%B0/" rel="tag"><i class="fa fa-tag"></i> 笔记</a>
              <a href="/blog/tags/RL/" rel="tag"><i class="fa fa-tag"></i> RL</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/blog/2020/06/18/rl-mdp/" rel="prev" title="Finite Markov Decision Processes & Rewards">
      <i class="fa fa-chevron-left"></i> Finite Markov Decision Processes & Rewards
    </a></div>
      <div class="post-nav-item">
    <a href="/blog/2020/05/27/%E6%9D%A8%E7%BB%9B%E8%AF%AD%E5%BD%95/" rel="next" title="杨绛语录">
      杨绛语录 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#The-k-armed-Bandit-Problem"><span class="nav-text">The k-armed Bandit Problem</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Action-Value-amp-increment-estimation"><span class="nav-text">Action-Value &amp; increment estimation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Epsilon-Greedy-amp-optimistic-initial-value"><span class="nav-text">Epsilon Greedy &amp; optimistic initial value</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Upper-Conﬁdence-Bound-Action-Selection"><span class="nav-text">Upper-Conﬁdence-Bound Action Selection</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Xiaoxiang Ma</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/blog/archives/">
        
          <span class="site-state-item-count">13</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/blog/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/blog/tags/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/xiaoxiang-ma" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;xiaoxiang-ma" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:xm53@cornell.edu" title="Email → mailto:xm53@cornell.edu" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>Email</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://medium.com/@xiaoxiangma" title="Medium → https:&#x2F;&#x2F;medium.com&#x2F;@xiaoxiangma" rel="noopener" target="_blank"><i class="fab fa-medium fa-fw"></i>Medium</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Xiaoxiang Ma</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div><br>
<a class="author" href="https://xiaoxiang-ma.github.io">Return to main page</a>


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/blog/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/blog/lib/velocity/velocity.min.js"></script>
  <script src="/blog/lib/velocity/velocity.ui.min.js"></script>

<script src="/blog/js/utils.js"></script>

<script src="/blog/js/motion.js"></script>


<script src="/blog/js/schemes/muse.js"></script>


<script src="/blog/js/next-boot.js"></script>




  















  

  

  

</body>
</html>
