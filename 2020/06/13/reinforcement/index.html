<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/blog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/blog/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="笔记,RL," />








  <link rel="shortcut icon" type="image/x-icon" href="/blog/favicon.ico?v=5.1.2" />






<meta name="description" content="Designs an agent that tries to maximize “reward” by trial and error.Not supervised, but not unsupervised either. Textbook The k-armed Bandit ProblemFaced repeatedly with a choice among k different o">
<meta property="og:type" content="article">
<meta property="og:title" content="RL - Bandit problem">
<meta property="og:url" content="http://xiaoxiang-ma.github.io/blog/2020/06/13/reinforcement/index.html">
<meta property="og:site_name" content="(▀̿Ĺ̯▀̿ ̿)">
<meta property="og:description" content="Designs an agent that tries to maximize “reward” by trial and error.Not supervised, but not unsupervised either. Textbook The k-armed Bandit ProblemFaced repeatedly with a choice among k different o">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://xiaoxiang-ma.github.io/blog/2020/06/13/reinforcement/1equation.png">
<meta property="og:image" content="http://xiaoxiang-ma.github.io/blog/2020/06/13/reinforcement/2actionvalue.png">
<meta property="og:image" content="http://xiaoxiang-ma.github.io/blog/2020/06/13/reinforcement/4.png">
<meta property="og:image" content="http://xiaoxiang-ma.github.io/blog/2020/06/13/reinforcement/5.png">
<meta property="og:image" content="http://xiaoxiang-ma.github.io/blog/2020/06/13/reinforcement/7.png">
<meta property="og:image" content="http://xiaoxiang-ma.github.io/blog/2020/06/13/reinforcement/6.png">
<meta property="og:image" content="http://xiaoxiang-ma.github.io/blog/2020/06/13/reinforcement/8.png">
<meta property="article:published_time" content="2020-06-14T02:06:45.000Z">
<meta property="article:modified_time" content="2020-06-19T00:44:00.861Z">
<meta property="article:author" content="mx^2">
<meta property="article:tag" content="笔记">
<meta property="article:tag" content="RL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://xiaoxiang-ma.github.io/blog/2020/06/13/reinforcement/1equation.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://xiaoxiang-ma.github.io/blog/2020/06/13/reinforcement/"/>





  <title>RL - Bandit problem | (▀̿Ĺ̯▀̿ ̿)</title>
  














<meta name="generator" content="Hexo 4.2.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/blog/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">(▀̿Ĺ̯▀̿ ̿)</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Ma blog</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/blog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/blog/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/blog/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/blog/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/blog/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://xiaoxiang-ma.github.io/blog/blog/2020/06/13/reinforcement/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="mx^2">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="(▀̿Ĺ̯▀̿ ̿)">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">RL - Bandit problem</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-13T22:06:45-04:00">
                2020-06-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/Data-Science/" itemprop="url" rel="index">
                    <span itemprop="name">Data Science</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <!-- ## Reinforcement Learning Notes -->

<p>Designs an agent that tries to maximize “reward” by trial and error.<br>Not supervised, but not unsupervised either.</p>
<p><a href="RL.pdf">Textbook</a></p>
<h2 id="The-k-armed-Bandit-Problem"><a href="#The-k-armed-Bandit-Problem" class="headerlink" title="The k-armed Bandit Problem"></a>The k-armed Bandit Problem</h2><p>Faced repeatedly with a choice among k different options. After each choice you receive a numerical reward chosen from a stationary probability distribution that depends on the action you selected. The objective is to maximize the expected total reward over some time period, for example, over 1000 action selections, or time steps.</p>
<!-- ![True value of action](1equation.png) -->
<img src="/blog/2020/06/13/reinforcement/1equation.png" class="" title="True value of action">

<p>Value of an action is the expected value of reward given that action is selected.</p>
<ul>
<li>q*(a): TRUE Value of an action (Note known)</li>
<li>Qt(a): estimated value of action a at time step t, We would like Q t (a) to be close to q*(a).</li>
<li>At: Action selected on time step t</li>
<li>Rt: Corresponding Reward on time step t</li>
</ul>
<p>Goal is to maximize argmax of q*(a)</p>
<blockquote>
<p>Each of the k actions has an expected or mean reward given that that action is selected; let us call this the value of that action. We denote the action selected on time step t as A t , and the corresponding reward as R t . The value then of an arbitrary action a, denoted q ⇤ (a), is the expected reward given that a is selected</p>
</blockquote>
<h2 id="Action-Value-amp-increment-estimation"><a href="#Action-Value-amp-increment-estimation" class="headerlink" title="Action-Value &amp; increment estimation"></a>Action-Value &amp; increment estimation</h2><p>Sample average method: Take the average of action-values so far.</p>
<!-- ![Sample avg (predicted) action value](2actionvalue.png) -->
<img src="/blog/2020/06/13/reinforcement/2actionvalue.png" class="" title="Sample avg (predicted) action value">

<!-- ![Action value](3.png) -->

<p>Action Selection:</p>
<ul>
<li>Exploit / Greedy: argmax Qt(a) (choose the current largest estimate action / most reward right now)</li>
<li>Explore: choose other than the largest estimate randomly.</li>
</ul>
<p><mark>Exploitation is the right thing to do to maximize the expected reward on the one step, but exploration may produce the greater total reward in the long run.</mark></p>
<!-- ![Increment (R = reward)](4.png) -->
<img src="/blog/2020/06/13/reinforcement/4.png" class="" title="Increment (R &#x3D; reward)">

<p>NewEstimate = OldEstimate + StepSize (Target - OldEstimate)</p>
<p><strong>Nonstationary Problem</strong><br>Performance changes with time. (e.g. a medicine more effective in winter)</p>
<!-- ![Constant step size](5.png) -->
<img src="/blog/2020/06/13/reinforcement/5.png" class="" title="Constant step size">

<ul>
<li>alpha is constant, more recent rewards affect more than older rewards.</li>
<li>weight decays exponentially according to the exponent on 1- alpha.</li>
</ul>
<h2 id="Epsilon-Greedy-amp-optimistic-initial-value"><a href="#Epsilon-Greedy-amp-optimistic-initial-value" class="headerlink" title="Epsilon Greedy &amp; optimistic initial value"></a>Epsilon Greedy &amp; optimistic initial value</h2><p>Epsilon = prob of choosing to explore.<br>The smaller, the longer it takes for curve to plateu.</p>
<!-- ![Epsilon](7.png) -->
<img src="/blog/2020/06/13/reinforcement/7.png" class="" title="Epsilon">

<!-- ![Optimistic int val](6.png) -->
<img src="/blog/2020/06/13/reinforcement/6.png" class="" title="Optimistic int val">

<ul>
<li><strong>Worse at first due to more exploration, exploration decreases with time (not goot for nonstationary problems).</strong></li>
<li>The system does a fair amount of exploration even if greedy actions are selected all the time.</li>
</ul>
<h2 id="Upper-Conﬁdence-Bound-Action-Selection"><a href="#Upper-Conﬁdence-Bound-Action-Selection" class="headerlink" title="Upper-Conﬁdence-Bound Action Selection"></a>Upper-Conﬁdence-Bound Action Selection</h2><p>Action selection method that chooses the most “unexplored” / “uncertain” actions when not choosing to exploit.</p>
<!-- ![UCB](8.png) -->
<img src="/blog/2020/06/13/reinforcement/8.png" class="" title="UCB">

<blockquote>
<p>N t(a) denotes the number of times that action a has been selected prior to time t (the denominator in (2.1)), and the number c &gt; 0 controls the degree of exploration. If N t (a) = 0, then a is considered to be a maximizing action.</p>
</blockquote>
<blockquote>
<p>The idea of this upper conﬁdence bound (UCB) action selection is that the square-root term is a measure of the uncertainty or variance in the estimate of a’s value. The quantity being max’ed over is thus a sort of upper bound on the possible true value of action a, with c determining the conﬁdence level. <strong><em>Each time a is selected the uncertainty is presumably reduced: N t (a) increments, and, as it appears in the denominator, the uncertainty term decreases.</em></strong> On the other hand, each time an action other than a is selected, t increases but N t (a) does not; because t appears in the numerator, the uncertainty estimate increases. The use of the natural logarithm means that the increases get smaller over time, but are unbounded; all actions will eventually be selected, but actions with lower value estimates, or that have already been selected frequently, will be selected with decreasing frequency over time.</p>
</blockquote>
<p><a href="summary.mp4">Week 1 Summary</a></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/blog/tags/%E7%AC%94%E8%AE%B0/" rel="tag"># 笔记</a>
          
            <a href="/blog/tags/RL/" rel="tag"># RL</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/blog/2020/05/27/%E6%9D%A8%E7%BB%9B%E8%AF%AD%E5%BD%95/" rel="next" title="杨绛语录">
                <i class="fa fa-chevron-left"></i> 杨绛语录
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/blog/2020/06/18/markovdecisionprocess/" rel="prev" title="Finite Markov Decision Processes">
                Finite Markov Decision Processes <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/blog/images/avatar.gif"
               alt="mx^2" />
          <p class="site-author-name" itemprop="name">mx^2</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/blog/archives/">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/blog/categories/index.html">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/blog/tags/index.html">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/xiaoxiang-ma" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                    
                      GitHub
                    
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#The-k-armed-Bandit-Problem"><span class="nav-number">1.</span> <span class="nav-text">The k-armed Bandit Problem</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Action-Value-amp-increment-estimation"><span class="nav-number">2.</span> <span class="nav-text">Action-Value &amp; increment estimation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Epsilon-Greedy-amp-optimistic-initial-value"><span class="nav-number">3.</span> <span class="nav-text">Epsilon Greedy &amp; optimistic initial value</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Upper-Conﬁdence-Bound-Action-Selection"><span class="nav-number">4.</span> <span class="nav-text">Upper-Conﬁdence-Bound Action Selection</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">mx^2</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next" target="_blank" rel="noopener">
    NexT.Muse
  </a>
</div>


        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/blog/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/blog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/blog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/blog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/blog/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/blog/js/src/motion.js?v=5.1.2"></script>



  
  

  
  <script type="text/javascript" src="/blog/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/blog/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/blog/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
